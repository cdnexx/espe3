<!DOCTYPE html>
{% extends 'core/base_territorial.html' %}
{%load static %}
{% block content %}
<style>
    /* Estilo adicional para el contenedor de la tabla en SweetAlert */
    .sweetalert-table-container {
        width: 110%; /* Ajusta el ancho del contenedor según tus necesidades */
        margin: 0 auto; /* Centra el contenedor en la pantalla */
    }
</style>
<div class="container-fluid">
    <div class="row">


<!-- Tarjeta solicitudes nuevas -->
<div class="col-xl-3 col-md-6 mb-4">
    <a href="{% url 'territorial_list' %}" class="text-decoration-none text-dark">
        <div class="card border-left-success shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-sm font-weight-bold text-success text-uppercase mb-1">
                            Crear Solicitud
                        </div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-poll fa-2x text-gray-300"></i>
                    </div>
                </div>
            </div>
        </div>
    </a>
</div>


        <!-- Tarjeta solicitudes activas -->
        <div class="col-xl-3 col-md-6 mb-4">
            <a href="#" class="text-decoration-none text-dark">
            <div class="card border-left-success shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                Solicitudes Enviadas</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">20</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-inbox fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </a>
        </div>

        <!-- Tarjeta solicitudes cerradas-->
        <div class="col-xl-3 col-md-6 mb-4">
            <a href="#" class="text-decoration-none text-dark">
            <div class="card border-left-warning shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                Solicitudes
                                En Proceso
                            </div>
                            <div class="row no-gutters align-items-center">
                                <div class="col-auto">
                                    <div class="h5 mb-0 mr-3 font-weight-bold text-gray-800">10</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-spinner fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </a>
        </div>

        <!-- Ultimos usuarios-->
        <div class="col-xl-3 col-md-6 mb-4">
            <a href="#" class="text-decoration-none text-dark">
            <div class="card border-left-primary shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                Últimos usuarios</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">12
                            </div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-check fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </a>
    </div>

    <!-- fin tarjetas -->

    <div class="row">
        <!-- seccion graficos -->
        <div class="col-xl-8 col-lg-7">
            <div class="card shadow mb-4">

                <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                    <h6 class="m-0 font-weight-bold text-primary">Estadísticas de solicitudes mensuales
                    </h6>

                </div>

                <div class="card-body">
                    <div class="chart-area">
                        <canvas id="myAreaChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Grafico torta-->
        <div class="col-xl-4 col-lg-5">
            <div class="card shadow mb-4">

                <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                    <h6 class="m-0 font-weight-bold text-primary">Solicitudes mensuales</h6>
                </div>

                <div class="card-body">
                    <div class="chart-pie pt-4 pb-2">
                        <canvas id="myPieChart"></canvas>
                    </div>
                    <div class="mt-4 text-center small">
                        <span class="mr-2">
                            <i class="fas fa-circle text-primary"></i> Solicitudes totales
                        </span>
                        <span class="mr-2">
                            <i class="fas fa-circle text-success"></i> Activas
                        </span>
                        <span class="mr-2">
                            <i class="fas fa-circle text-info"></i> Cerradas
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- maps-->
    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title">Georeferencia de Municipalidad</h5>
                </div>
                <div class="card-body">
                    <iframe
                        src="https://www.google.com/maps/embed?pb=!1m16!1m12!1m3!1d4705.915676891774!2d-70.64939377187373!3d-33.4861568249901!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!2m1!1smunicipalidad%20san%20miguel!5e0!3m2!1ses-419!2scl!4v1700365603547!5m2!1ses-419!2scl"
                        width="100%" height="500" style="border:0;" allowfullscreen="" loading="lazy"
                        referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
            </div>
        </div>
    </div>
</div>
</div>


<!-- Llamada del footer -->
{% include 'core/footer.html' %}

</div>

</div>



<!-- plugins -->
<script src="{% static '/registration/vendor/chart.js/Chart.min.js' %}"></script>

<!-- scripts graficos-->
<script src="{% static '/registration/js/demo/chart-area-demo.js' %}"></script>
<script src="{% static '/registration/js/demo/chart-pie-demo.js' %}"></script>
<script>
    function openSelectionModal() {
        // Abre SweetAlert para seleccionar dirección y departamento
        Swal.fire({
            title: 'Seleccionar Dirección y Departamento',
            html: `<div class="swal2-input-group">
                        <select id="direccion" class="swal2-input">
                            <option value="direccion1">Dirección 1</option>
                            <option value="direccion2">Dirección 2</option>
                        </select>
                        <select id="departamento" class="swal2-input">
                            <option value="departamento1">Departamento 1</option>
                            <option value="departamento2">Departamento 2</option>
                        </select>
                    </div>`,
            focusConfirm: false,
            showCancelButton: true,
            confirmButtonText: 'Aceptar',
            cancelButtonText: 'Cancelar',
            confirmButtonColor: '#134982',
            preConfirm: () => {
                const direccion = Swal.getPopup().querySelector('#direccion').value;
                const departamento = Swal.getPopup().querySelector('#departamento').value;
                openSolicitudesListModal(direccion, departamento);
            }
        });
    }

    function openSolicitudesListModal(direccion, departamento) {
    const listaSolicitudes = [
        { id: 1, name: 'Solicitud 1', incident: 'Tipo 1' },
        { id: 2, name: 'Solicitud 2', incident: 'Tipo 2' },
        { id: 3, name: 'Solicitud 3', incident: 'Tipo 3' }
    ];

    const tableHtml = `
        <div class="table-responsive">
            <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Tipo Incidencia</th>
                        <th>Acción</th>
                    </tr>
                </thead>
                <tbody>
                    ${listaSolicitudes.map(solicitud => `
                        <tr class="incident-row" data-incident="${solicitud.incident}">
                            <td class="incident-name">${solicitud.name}</td>
                            <td class="incident-type">${solicitud.incident}</td>
                            <td class="text-end">
                                <a href="{% url 'territorial_poll_view' 1 %}"
                                    class="btn btn-sm btn-secondary me-2 mb-2 mb-sm-0 btn-ver" style="background-color: #6c757d; color: white; min-width: 80px;">
                                    <i class="fas fa-eye me-1"></i>
                                </a>
                            </td>
                        </tr>
                    `).join('')}
                </tbody>
            </table>
        </div>
    `;

    // Abre SweetAlert con la lista de solicitudes en formato de tabla
    Swal.fire({
        title: `Seleccionar Solicitud`,
        html: tableHtml,
        icon: 'info',
        showConfirmButton: false,
        showCancelButton: true,
            cancelButtonText: 'Cancelar',

        customClass: {
            container: 'sweetalert-table-container'
        }
    });
}
</script>

</body>

</html>
{% endblock %}